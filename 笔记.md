# React 框架基础

- React 是 facebook 推出的用于构建用户界面的前端JS框架

- React 是 使用组件构建用户界面

组件开发的优势

1. 将一个庞大复杂的应用程序拆分成多个独立单元

2. 组件之间相互独立，有利于应用程序的维护

3. 组件可以复用

## JSX 语法

1. JSX 可以看作是JS语言的扩展，它既不是一个字符串，也不是一个HTML
2. 它具备了 JS 所有的功能，同时还可以被转为 HTML 在页面上展示 （基于 react react-dom）
3. 本身就是一个表达式，可以当作变量，返回值等
4. 使用单标签需要闭合

- 动态显示数据，插值表达式 `<div>{value}<div>`
  - 不能填入对象
  - `undefined`、`false`、`null`不显示

- 调用方法 `<p>{sayHello()}</p>`

- 支持表达式`<div>{1+2}</div>`
  - 支持三目运算符，不支持`if else`

- 支持模板字符串

- 注释 `{/* 这是注释内容 */}`

## JSX 事件操作

- 事件绑定

```jsx
  <button onClick={handler} >点击触发</button>
  <button onClick={() => { handle(1, 2) }} >点击触发</button>
  <button onClick={handler2.bind(null, 1, 2)} >点击</button>
```

- 事件监听传参

  1. 箭头函数
  2. bind

- 获取事件对象

```js
  <button onClick={handler3} >点击</button>
  <button onClick={(e) => {handler3(e) }} >点击</button>
  <button onClick={handler2.bind(null, 1, 2)} >点击</button>
```

## 循环数据

1. JSX 可以直接将数组解构
2. 可以通过map函数将数组项转换为需要的jsx对象

## 设置内联样式

```jsx
  <div style={{ color: 'red' }}>
    样式处理
  </div>
```

内联样式默认无法支持媒体查询、伪类
- 可以通过 radium 库解决

## 设置外联样式

1. 全局外联样式
  - 所有组件中都可使用

2. 组件级别外联样式
  - 只有某个组件可用
  - 组件名.module.css








## 组件

1. 创建函数组件

2. 创建类组件

  - 必须继承 Component 需要有 render 方法
  - 组件名首字母大写，在 React 中用以区分组件和普通元素

## 往组件传递数据

1. 在组件上添加属性，传递数据

  - 类组件中存在一个 props 属性，外部传递的数据都可以通过该属性访问 `this.props.xxx`
  - 函数组件的参数为 props 用以接收数据

2. 数据统一管理，利用展开运算符

  - `<ComponetA {...obj} />`

## 默认值及类型校验

- 默认值

1. 函数组件，如果想要设置默认的 props 属性值，则直接通过 组件名称.defaultProps 来设置一个对象
  ```jsx
    Header.defaultProps = {
      age: 18
    }
  ```

2. 类组件，直接定义 static defaultProps 来管理需要设置默认值的属性
  ```jsx
    static defaultProps = {
      age: 20
    }
  ```

- 类型校验

1. 函数组件

  ```jsx
    Header.propTypes = {
      name: PropTypes.string.isRequired
    }
  ```

2. 类组件

  ```jsx
    static propTypes = {
      name: PropTypes.string
    }
  ```

## 向组件传递JSX

通过 chilren 属性可以拿到标签内的子元素

类组件
`this.props.children`

函数组件
`props.children`

## 组件状态

react-03-state.js

组件状态：某个组件自己的数据
数据驱动 DOM：修改某个数据时，界面上DOM数据自动更新
组件状态管理

- 类组件

  - 在类组件中默认存在一个 state 属性，它是一个对象，可以用于保存当前组件的数据

  - 可以通过 setState 方法来修改数据

## setState

1. setState 是异步操作

可以将事件设置为 async 通过 await 等待 setState

允许传递第二个参数，是一个函数，函数在状态更新后执行

2. setState 可以传入一个函数

- 传入函数和对象的区别

  1. 传入函数的话，多次调用多次执行
  2. 传入对象的话，合并到最后一次

## 组件中的 this

## 单向数据流

何为单向数据流

- 单向数据流的设计原则要求我们将不同组件之间需要共享的数据都定义在上层

数据如何修改

特点

1. 单向数据流。自顶向下，从父组件传递到子组件
2. 基于单向数据流，共享数据定义在上层组件
3. 子组件通过调用父组件传递的方法更改数据
4. 数据发生改变， React 会重新渲染组件树

## 表单

- 受控表单

表单元素的值由 React 来进行管理，表单值放在 state 中，值从 state 获取

- 非受控表单

不受 React 管理，表单元素数据由 DOM 元素本身管理，表单元素的值也是存放在 DOM 元素内，操作数据需要操作 DOM 元素 (通过 ref 获取  DOM 元素)

- 受控表单值绑定域数据同步






## 生命周期

1. 挂载组件阶段

  - 组件被创建然后插入 DOM 中
  - 生命周期方法
    1. constructor        设置组件初始配置
    2. render             解析JSX，在界面上显示
    3. componentDidMount  组件挂载完成
      - 发送网络请求
      - 添加定时器
      - 添加事件监听
      - 获取DOM

2. 组件更新阶段

> 数据发生变化组件发生更新，重新渲染

  - 当数据更新后
  - 当外不传入的 props 以及自身的状态 state
  - 生命周期方法
    1. shouldComponentUpdate(nextProps, nextState)
      - 返回boolean 默认返回 true 返回 false 则组件不更新（后续方法不执行）
    2. render
    3. componentDidUpdate
      - 组件更新完成后执行

3. 组件卸载阶段

> 将组件从 DOM 上删除

  - componentWillUnMount
    - 清除事件监听
    - 清除定时器
    - ...

## React AJAX 请求

axios 库

- 请求转发（跨域问题）

  1. 配置 package.json 的 proxy 字段
    - proxy 填写目标服务器地址
    - React 请求路径只填写 路径部分

  2. http-proxy-middleware

## 模拟数据

mockjs 库

## redux

redux react-redux 库

解决组件间通信的问题 

Redux 是一个数据管理框架，提供了一个叫 store 的统一数据存储的仓库
store 可以让组件之间无需再进行数据传递

1. 通过 Provider 包裹组件 设置 store 属性
2. 使用数据的组件使用 connect

## redux 工作流程

1. 创建 store 存储数据 （creatStore(reducer)）

  `const store = createStore()`

2. 创建 reducer

  - state: reducer 处理完数据后返回给 store 进行存储的数据
  - action: store 传递给 reducer 的具体指令

  ```js
    function reducer (state, action) {
      switch (action.type) {
        case "type1":
          return {
            key: value
          }
        default:
          return state
      }
    }
  ```

3. 定义初始的 store 数据

```jsx
  const initialState = {
    content: ['默认数据']
  }
```

4. provider 传递 store

`<Provider store={store}> <App/> </Provider>`


1. 创建 store 保存数据关联 reducer
2. 利用 provider 将 store 向后传递
3. 在具体的组件当中使用 connect 方法获取 store 里保存的数据，通过组件的 Props 进行访问
4. 拿到数据进行渲染